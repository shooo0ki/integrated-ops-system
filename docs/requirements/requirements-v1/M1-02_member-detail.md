# M1-02 メンバー詳細 — 要件定義 v1

## 機能要件

| 優先度 | 要件 |
|--------|------|
| Must | 指定メンバーのプロフィール情報を表示する |
| Must | 報酬情報（報酬形態・金額）は管理者のみ表示する |
| Must | 銀行口座情報は管理者と本人のみ表示する |
| Must | アサイン中プロジェクト一覧を表示する（表示範囲はロール別に制御） |
| Must | スキル評価サマリー（カテゴリ別の最新レベル）を表示する |
| Must | 管理者は全メンバーの詳細にアクセスできる |
| Must | マネージャーは担当 PJ メンバーのみアクセスできる |
| Must | 社員・インターンは自分自身のみアクセスできる |
| Must | 権限外のメンバー詳細へのアクセスは 403 を返す |
| Must | 存在しない ID へのアクセスは 404 を返す |
| Should | 編集ボタンを表示し、M1-03 編集フォームに遷移する（権限を持つロールのみ） |
| Should | アサイン中 PJ 名クリックで M3-02 プロジェクト詳細に遷移する |
| Should | スキル評価クリックで M2-03 スキル評価入力に遷移する |

## 受け入れ条件（Acceptance Criteria）

- [ ] 管理者でアクセスすると全項目（報酬・銀行口座含む）が表示される
- [ ] マネージャーでアクセスすると報酬・銀行口座が非表示
- [ ] 社員・インターンが自分の詳細を開くと銀行口座が表示される
- [ ] 社員が他メンバーの詳細を開くと 403 が返る
- [ ] マネージャーが担当外 PJ メンバーの詳細を開くと 403 が返る
- [ ] 存在しない ID にアクセスすると 404 が返る
- [ ] 管理者に「編集」ボタンが表示され、クリックで M1-03 に遷移する
- [ ] 社員・インターン（本人）に「編集」ボタンが表示され、クリックで M1-03 に遷移する（編集可能項目は制限）

## データ要件

| エンティティ | 項目 | 表示条件 |
|------------|------|---------|
| `MEMBER` | name, email, phone, address | 全ロール（管理者は全員、その他は本人 or 担当 PJ） |
| `MEMBER` | joined_at, left_at | 全ロール（表示条件と同様） |
| `MEMBER` | status, role | 全ロール（閲覧のみ） |
| `MEMBER` | salary_type, salary_amount | 管理者のみ |
| `MEMBER` | bank_name, branch_name, account_number, account_holder | 管理者 + 本人のみ（暗号化保存） |
| `PROJECT_ASSIGNMENT` | project_id, position, workload_hours, start_date, end_date | 権限内 PJ のみ |
| `MEMBER_SKILL` | skill_id, level, evaluated_at | 権限内 |

## 非機能要件（暫定）

| 区分 | 内容 |
|------|------|
| 性能 | ページ表示 3 秒以内 |
| セキュリティ | 銀行口座情報は DB 上で暗号化保存。API レスポンスでも権限なしロールには返さない。アクセス制御はサーバー側で必ず検証 |
| 監査 | 詳細閲覧ログ（閲覧者・対象メンバー・タイムスタンプ）を記録。銀行口座参照は別途記録 |
| ログ | 403 / 404 発生をサーバーログに記録 |

## 想定エラーと対処

| エラー条件 | 表示 / 挙動 | 対処方針 |
|-----------|------------|---------|
| 存在しない ID | 404 ページ表示 | — |
| 権限外のメンバーにアクセス | 403 ページ表示 | — |
| データ取得失敗 | エラートースト | リロード案内 |
