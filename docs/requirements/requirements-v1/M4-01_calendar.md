# M4-01 全体カレンダー — 要件定義 v1

## 機能要件

| 優先度 | 要件 |
|--------|------|
| Must | 全メンバーの勤務予定（薄色）と出勤実績（濃色）をカレンダー形式（行: メンバー / 列: 日付）で表示する |
| Must | 週間 / 日別 / 月別で表示期間を切り替えられる |
| Must | PJ / 所属会社 / メンバーでフィルタリングができる |
| Must | 勤務予定があり当日以前で実績未打刻の日をオレンジ強調する（打刻漏れ候補） |
| Must | 管理者は全員を閲覧できる |
| Must | マネージャーは担当 PJ メンバー + 自分を閲覧できる |
| Must | 社員は全員を閲覧できる（勤務時刻の基本情報のみ） |
| Must | インターンは担当 PJ メンバー + 自分を閲覧できる |
| Should | メンバー名クリックで M1-02 メンバー詳細に遷移する |
| Should | セルクリックで当日の勤怠詳細（出退勤時刻・日報）をモーダル等で表示する |

## 受け入れ条件（Acceptance Criteria）

- [ ] 管理者でアクセスすると全メンバーのカレンダーが表示される
- [ ] マネージャーでアクセスすると担当 PJ メンバー + 自分のカレンダーが表示される
- [ ] 勤務予定あり・打刻なしの過去日がオレンジ強調される
- [ ] 出勤実績は濃い緑で表示される
- [ ] 週間 / 日別 / 月別の切り替えが正常に動作する
- [ ] PJ フィルターで特定 PJ のメンバーのみ表示される
- [ ] データ取得失敗時にエラートーストが表示される

## データ要件

| エンティティ | 項目 | 備考 |
|------------|------|------|
| `WORK_SCHEDULE` | member_id, date, start_time, end_time | 勤務予定 |
| `ATTENDANCE` | member_id, date, clock_in, clock_out | 出勤実績 |
| `MEMBER` | id, name | 行ヘッダー |
| `PROJECT_ASSIGNMENT` | member_id, project_id | マネージャー・インターンのフィルタ用 |

打刻漏れ候補の条件:
- `WORK_SCHEDULE.date < today`
- かつ `ATTENDANCE` に当日レコードなし

## 非機能要件（暫定）

| 区分 | 内容 |
|------|------|
| 性能 | カレンダー表示 3 秒以内。週間表示で最大 100 名 × 7 日 = 700 セルを想定 |
| セキュリティ | 認証必須。マネージャー・インターンの閲覧範囲制限はサーバー側で適用 |
| 監査 | 閲覧ログ（ユーザー・タイムスタンプ）を記録 |
| ログ | API エラーをサーバーログに記録 |

## 想定エラーと対処

| エラー条件 | 表示 / 挙動 | 対処方針 |
|-----------|------------|---------|
| データ取得失敗 | エラートースト表示 | リロード案内 |
