# M3-05 工数管理

## 目的
PJ 別・メンバー別の月間工数を確認・修正する。複数 PJ 掛け持ち時の稼働配分を管理する。

## 対象ペルソナ / シナリオ
- 田中（マネージャー）: 月次工数の確認と微調整

## UI 構成
- 対象月選択（月ピッカー）
- メンバー × PJ マトリクス（行: メンバー / 列: PJ / セル: 工数時間）
- 合計行・合計列
- 編集モード切替

## 入力項目
| 項目 | 必須 | 制約 | 例 |
|------|------|------|----|
| 工数（時間） | 必須 | 0 以上の数値 | `80` |
| 対象月 | 必須 | YYYY-MM | `2026-03` |

## 表示項目
| 項目 | 説明 |
|------|------|
| メンバー名 | — |
| PJ 名 | — |
| 月間工数（時間） | アサイン設定値 / 実績値を並べて表示 |
| 合計工数 | 行・列の合計 |

## 操作
| 操作 | 説明 |
|------|------|
| 月切り替え | 前月・翌月ナビゲーション |
| セル直接編集 | 工数値を直接入力（編集モード） |
| 週次まとめ編集 | 勤怠配分から計算された週実働を上書き入力（週ごと、PJごと）。合計≠週実働は保存不可 |
| 保存 | 変更を一括保存 |

## エラー / 例外
| 条件 | 挙動 |
|------|------|
| 工数が負の値 | 「0 以上の値を入力してください」 |
| 週次まとめ配分合計 ≠ 週実働 | 「配分合計が週実働と一致しません」保存不可 |

## 権限（ロール別）
| ロール | 操作 |
|--------|------|
| 管理者 | 全 PJ・全メンバー閲覧・編集 |
| マネージャー | 担当 PJ のみ閲覧・編集（週次まとめ配分含む） |
| メンバー（社員・インターン共通） | 不可 |

## 関連データ（エンティティ）
- `PROJECT_ASSIGNMENT`、`ATTENDANCE`、`PROJECT`、`MEMBER`

## 関連 API
- `GET /api/workload?month=&projectId=`
- `PUT /api/workload`
