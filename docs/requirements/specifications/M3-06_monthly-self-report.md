# M3-06 月次プロジェクト工数自己申告

## 目的
メンバーが月末に「どのプロジェクトにどれくらい工数を割いたか」を概算で自己申告する。
PL 計算の人件費按分および工数管理（M3-05）の入力ソースとなる。

> **設計メモ**: 申告は概算・本人による入力で良い。管理者・マネージャーが M3-05 で確認・修正可能。
> 打刻の実績時間と完全に一致していなくても保存できる（警告表示のみ）。

## 対象ペルソナ / シナリオ
- 山田（インターン）・鈴木（社員）: 月末にプロジェクト別の工数を申告
- 田中（マネージャー）: 申告状況を確認し、未申告メンバーをフォロー

## UI 構成
- 対象月表示（当月 or 前月のみ入力可）
- アサイン中 PJ 一覧（自動表示）
- 各 PJ に対する申告工数入力（時間）
- 合計工数 vs 実働時間の差異表示
- 申告完了ボタン

## 入力項目
| 項目 | 必須 | 制約 | 例 |
|------|------|------|----|
| 対象月 | 必須 | 当月 or 前月のみ | `2026-02` |
| プロジェクト別工数（時間） | 必須（アサインがある場合） | 0 以上の数値 | `40` |

> **合計チェック**: 申告工数合計 ≠ 実働時間（打刻集計）の場合、保存は可能だが「実働時間と X 時間の差があります」と警告を表示する。

## 表示項目
| 項目 | 説明 |
|------|------|
| プロジェクト名 | アサイン中のもの自動表示 |
| 申告工数（時間） | 入力欄 |
| 合計申告工数 | 自動集計 |
| 当月実働時間 | 打刻実績から自動表示 |
| 差異 | 合計申告工数 − 実働時間 |
| 申告ステータス | 未申告 / 申告済み |

## 操作
| 操作 | 説明 |
|------|------|
| 工数入力 | 各 PJ の工数を時間単位で入力 |
| 申告完了 | 保存し「申告済み」ステータスへ変更（再編集は当月中のみ可） |

## エラー / 例外
| 条件 | 挙動 |
|------|------|
| 合計申告工数 ≠ 実働時間 | 「実働時間と X 時間の差があります（保存可）」警告トースト |
| 翌月以降の申告 | 「対象月の申告は締め切られています」でブロック |

## 申告状況確認（管理者・マネージャー向け）
- 全メンバーの申告状況一覧（申告済み / 未申告 / 差異あり）をバナーまたは別ビューで表示
- 未申告メンバーへの Slack リマインドボタン（任意）

## 権限（ロール別）
| ロール | 操作 |
|--------|------|
| 管理者 | 全員の申告状況確認・編集 |
| マネージャー | 担当 PJ メンバーの申告状況確認 |
| メンバー（社員・インターン共通） | 自分の申告のみ入力・確認 |

## 関連データ（エンティティ）
- `ATTENDANCE_ALLOCATION`（勤怠プロジェクト配分）、`PROJECT_ASSIGNMENT`、`ATTENDANCE`、`MEMBER`

## 関連 API
- `GET /api/workload/self-report?month=`（自分の申告状況取得）
- `POST /api/workload/self-report`（申告保存）
- `GET /api/workload/self-report/status?month=`（管理者向け: 全員の申告状況）
