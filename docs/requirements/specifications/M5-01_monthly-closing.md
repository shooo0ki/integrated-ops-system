# M5-01 月末締め管理

## 目的
月末の勤怠締め処理を管理する。未確認メンバーへの通知・集計実行・請求書生成トリガーを一元管理。S2 シナリオの起点。

## 対象ペルソナ / シナリオ
- 佐藤（管理者）: S2 月末集計トリガー・全体進捗確認

## UI 構成
- 対象月表示
- 時給制メンバー一覧テーブル（確認状況）
- 集計実行ボタン
- Slack 確認依頼送信ボタン（未確認者へ一括）
- 強制確定ボタン（期限超過時）

## 表示項目（メンバー一覧テーブル）
| 項目 | 説明 |
|------|------|
| 氏名 | — |
| 勤務日数 | — |
| 合計実働時間 | — |
| 給与見込み額 | — |
| 確認状態 | 未送信 / 確認待ち / 確認済 / 修正依頼中 |
| 請求書状態 | 未生成 / 生成済 / 送付済 |
| 未打刻日数 | 0 件以外はオレンジ強調 |

## 操作
| 操作 | 説明 |
|------|------|
| 集計実行 | 当月の全勤怠データを集計して給与を計算 |
| Slack 確認依頼送信 | 未確認メンバーへ Slack メンション一括送信 |
| 再通知 | 特定メンバーに再度 Slack 通知 |
| 強制確定 | 未確認メンバーを強制的に確認済みとし請求書生成へ進める |
| 請求書生成 | 確認済みメンバー全員の請求書を一括生成 |

## Slack 通知内容（確認依頼）
```
@[氏名]さん 今月の勤怠を確認してください
勤務日数: X日 / 合計時間: Y時間 / 給与見込: Z円
確認はこちら: [リンク]
```

## エラー / 例外
| 条件 | 挙動 |
|------|------|
| 未打刻日ありで集計実行 | 警告ダイアログ「X 名に未打刻日があります。このまま集計しますか？」 |
| Slack 送信失敗 | エラートースト。個別再送ボタンを表示 |

## 権限（ロール別）
| ロール | アクセス |
|--------|---------|
| 管理者 | フルアクセス |
| その他 | アクセス不可 |

## 関連データ（エンティティ）
- `ATTENDANCE`、`MEMBER`、`INVOICE`

## 関連 API
- `GET /api/monthly-closing/:month`
- `POST /api/monthly-closing/:month/aggregate`
- `POST /api/monthly-closing/:month/notify`
- `POST /api/monthly-closing/:month/force-confirm/:memberId`
- `POST /api/monthly-closing/:month/generate-invoices`
