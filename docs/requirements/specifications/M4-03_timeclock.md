# M4-03 打刻画面

## 目的
出勤・退勤の打刻と日報の入力を完了する。1 分以内に完了できる UX が必須。

## 対象ペルソナ / シナリオ
- 山田（インターン）・鈴木（社員）: 毎日の打刻 + 日報

## UI 構成

### 出勤前（未打刻）
- 現在時刻の大きな表示
- **勤務場所選択**（オフィス / オンライン）← **必須**
- 「今日やること」テキストエリア（必須）
- 「出勤する」ボタン（大きく目立つ）

### 出勤後・退勤前
- 出勤時刻 + 勤務場所の表示
- 「退勤する」ボタン
- 休憩時間入力（分）
- 「今日やったこと」テキストエリア（必須）
- 「明日やること」テキストエリア（必須）

### 退勤後
- 本日の勤務サマリー（出勤・退勤・実働時間・勤務場所）
- 「勤怠一覧を見る」リンク

## 入力項目
| 項目 | 必須 | 制約 | 例 |
|------|------|------|----|
| **勤務場所（出勤時）** | **必須** | **オフィス / オンライン** | `オフィス` |
| 今日やること（出勤時） | 必須 | 最大 500 文字 | `〇〇機能の実装` |
| 休憩時間（退勤時） | 必須 | 0 以上の整数（分） | `60` |
| 今日やったこと（退勤時） | 必須 | 最大 500 文字 | `〇〇機能を完成させた` |
| 明日やること（退勤時） | 必須 | 最大 500 文字 | `テストを書く` |
| プロジェクト配分（退勤時） | 任意 | PJごとに時間または割合を入力。合計が実働と一致しないと警告 | `Boost 80% → 5h` |

## 操作
| 操作 | 結果 |
|------|------|
| 出勤ボタン押下 | 現在時刻 + 勤務場所で出勤記録。Slack 通知（今日やること含む） |
| 退勤ボタン押下 | 現在時刻で退勤記録 + 実働時間算出 + Slack 通知 |

## Slack 通知内容
### 出勤時
```
[氏名] が出勤しました（HH:MM）[勤務場所: オフィス/オンライン]
本日のタスク: [今日やること]
```

### 退勤時
```
[氏名] が退勤しました（HH:MM）
勤務時間: X時間Y分 / [勤務場所]
実績: [今日やったこと]
明日の予定: [明日やること]
```

## エラー / 例外
| 条件 | 挙動 |
|------|------|
| 勤務場所未選択で出勤 | 「勤務場所を選択してください」 |
| 「今日やること」未入力で出勤 | 「今日やることを入力してください」 |
| Slack 通知失敗 | 打刻は成功。「Slack 通知に失敗しましたが、打刻は記録されました」トースト |
| 二重出勤 | 「本日はすでに出勤済みです」 |

## 権限（ロール別）
- 全ロール: 自分の打刻のみ操作可

## 関連データ（エンティティ）
- `ATTENDANCE`、`MEMBER`

## 関連 API
- `GET /api/attendance/today`
- `POST /api/attendance/clock-in`（勤務場所パラメータ追加）
- `POST /api/attendance/clock-out`

## ワイヤーフレーム（ASCII）
```
┌───────────────────────── 打刻（未出勤） ─────────────────────────┐
│ 現在時刻 09:58                                                    │
│                                                                    │
│ 勤務場所: [🏢 オフィス]  [💻 オンライン]  ← 必須                 │
│ 今日やること: [______________________________] (必須)             │
│                                                                    │
│             [ 出勤する ]                                          │
└──────────────────────────────────────────────────────────────────┘

┌───────────────────── 打刻（出勤後・退勤前） ─────────────────────┐
│ 出勤時刻 10:00  [💻 オンライン]                                   │
│ 休憩(分): [  0 ]                                                  │
│ 今日やったこと: [______________________________] (必須)           │
│ 明日やること:   [______________________________] (必須)           │
│                                                                    │
│             [ 退勤する ]                                          │
└──────────────────────────────────────────────────────────────────┘
```
